<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Example Projects: Bootloader</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1><a class="anchor" name="page_bootloader">Bootloader</a></h1><h2><a class="anchor" name="page_update_firmware_introduction">
Introduction</a></h2>
The bootloader consists out of two parts:<ul>
<li>The bootloader program contained on the target board.</li><li>The <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a> Application that runs on a PC.</li></ul>
<p>
Some Modtronix Ethernet enabled boards are programmed with a network bootloader for updating firmware. When powering up the board, the network bootloader program will be executed for a configured time. During this time, it will look for connection messages received via UDP port 54211 from the <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a> Application. If found, the target board will remain in bootloader mode and wait for further instructions from the <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a>. If not found, it will jump to and start executing the user program.<h2><a class="anchor" name="page_update_firmware_netloader">
Updating the Firmware with the Modtronix Network Bootloader</a></h2>
The <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a> application is a user friendly program that is used to update the firmware on a Modtronix Ethernet enabled SBC board with bootloader. No PIC programmer is required. The SBC board used must have a bootloader installed on it. Such a board can be identified by a <em><b>BLN Vm.nn</b></em> label on the front of the board - normally stuck on the RTL8019AS 100 pin network chip. Where <em><b>Vm.nn</b></em> is the version number of the bootloader. The image below shown an example of the label on a board with a V1.00 bootloader. <div align="center">
<img src="label.jpg" alt="label.jpg">
</div>
<p>
For the latest version of the Modtronix Network Bootloader application, please go to <a href="http://www.modtronix.com/soft/netloader" target="_blank">www.modtronix.com/soft/netloader</a>.<h3><a class="anchor" name="page_update_firmware_local">
Updating the firmware on a local target board</a></h3>
To update the firmware on a local board, follow the following steps: <ul>
<li>
Ensure the target board is connected to the network, and switched off (no power applied). </li>
<li>
Download, install and start the <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a> application. </li>
<li>
Enter the IP address in the "Target IP Address" field. The default IP address is "10.1.0.1" </li>
<li>
Load the new firmware (has to be a hex file) by clicking on the "Browse" button. For example, use the "websrvr_mc.hex" file contained in the "../src" folder of the downloaded firmware. </li>
<li>
Click on the "Connect" button. This will start sending UDP packets onto the network trying to connect with the bootloader on the target board. </li>
<li>
Apply power to the target board </li>
<li>
You should see a message in the "Message Window" stating that connection has been made with the target board </li>
<li>
Click on the "Upgrade Firmware" button. The progress of the firmware upgrade will be shown in the "Message Window". </li>
<li>
When finished, the target board will automatically be reset, and will start up with the new firmware. </li>
</ul>
<h3><a class="anchor" name="page_update_firmware_remote">
Updating the firmware on a remote target board</a></h3>
The firmware can also be updated from a remote location, via the internet for example. For this to be possible, both the target board and Modtronix Network Bootloader should be connected to the same network or the internet. A way is needed to remotely reset the target device so it can enter bootloader mode for the configured time. The Modtronix TCP/IP Stack has a reset button on the the password protected "System" page of its web interface. The user has to access this page and reset the target by clicking on this button. After resetting the target board, it will remain in bootloader mode for the configured time. The procedure for updating the firmware is:<p>
<ul>
<li>
Start the Modtronix Network Bootloader program, select the desired IP address and hex file, and click the "Connect" button. It will now start searching for the bootloader device </li>
<li>
Reset the target board by clicking on the "Reset" button on the "System" page of the target board's web interface. </li>
<li>
The Modtronix Network Bootloader should now find the device, and establish a connection. </li>
<li>
After connected, click on the "Update Firmware" button to update the firmware. After successfully updating the firmware, the target board will be reset. </li>
</ul>
<h3><a class="anchor" name="page_update_firmware_error">
Updating the firmware on a faulty board</a></h3>
To update the firmware via the Modtronix Network Bootloader the following must be true:<ul>
<li>We have to know the IP address of the target board.</li><li>The configuration data stored in the target board's EEPROM must not be corrupted. This configuration data is used to set the board's IP address, how long it remains in bootloader mode after power up...</li></ul>
<p>
If for some reason, this EEPROM becomes corrupted, or the user does not know the IP address the device is configured for, the device can be powered up in <a class="el" href="page_safemode.html">Safemode</a>. For details, see <a class="el" href="page_safemode.html">Safemode</a>. When we start the target board in this mode, it will remain in bootloader mode until it has been programmed via the <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a>. We can also use any of the following IP addresses to access it:<ul>
<li>10.1.0.1</li><li>192.168.1.1</li><li>192.168.0.1</li></ul>
<p>
The procedure for programming it via the bootloader will be the same as given above in the <a class="el" href="page_bootloader.html#page_update_firmware_local">Updating the firmware on a local target board</a> section. <hr size="1"><address style="text-align: right;"><small>Generated on Wed Jul 11 11:34:38 2007 for Example Projects by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
