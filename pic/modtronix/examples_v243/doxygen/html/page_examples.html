<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Modtronix TCP/IP Stack Example Projects: Examples</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1><a class="anchor" name="page_examples">Examples</a></h1><ul>
<li><a class="el" href="page_examples.html#page_examples_introduction">Introduction</a></li><li><a class="el" href="page_examples.html#page_examples_target">Specifying the target board</a></li><li><a class="el" href="page_examples.html#page_examples_bootloader_compile">Compiling code for the Bootloader</a></li><li><a class="el" href="page_examples.html#page_examples_bootloader_compile_non">Compiling code for use without Bootloader</a></li><li><a class="el" href="page_examples.html#page_examples_firmware_netloader">Updating the Firmware with the Modtronix Network Bootloader</a></li><li><a class="el" href="page_examples.html#page_examples_firmware_programer">Updating the Firmware with a PIC Programmer</a></li><li><a class="el" href="page_examples.html#page_update_webpages">Modifying And Updating The Web Pages</a></li></ul>
<h2><a class="anchor" name="page_examples_introduction">
Introduction</a></h2>
The examples contained with the Modtronix TCP/IP Stack can be built to be used with a target board with or without a bootloader. Some Modtronix Ethernet enabled boards are delivered programmed with a network bootloader for updating the firmware. Such a board can be identified by a <em><b>BLN Vm.nn</b></em> label on the front of the board - normally stuck on the RTL8019AS 100 pin network chip. Where <em><b>Vm.nn</b></em> is the version number of the bootloader.<p>
All examples are supplied with <em>"*.mcp"</em> <a class="el" href="tools.html#tools_mplab">MPLAB IDE</a> project files (in "src" folder of example). To compile the project, all the user has to do is open this project file in <a class="el" href="tools.html#tools_mplab">MPLAB IDE</a> and click on the "Build All" toolbar. This will create the hex file for programming the board with.<p>
The name of the MPLAB project file indicates the following:<ul>
<li>What project it will compile</li><li>For what target device the project is compiled</li><li>What compiler is used</li><li>If it creates code for a board with or without a bootloader</li></ul>
<p>
The name of the MPLAB project file has the following format: <em>projectname_target_bootloader_compiler.mcp</em><ul>
<li>The <em>projectname</em> part gives the name of the project. For example "udp1", "tcp1"...</li><li>The <em>target</em> part gives the name of the target device and it's hardware version. For example "65hw201" will indicate that the project creates code for the SBC65EC Hardware version 2.01.</li><li>The <em>bootloader</em> part indicates if the project creates code for use with a bootloader board or not. It is is NOT present the code is created for a board with a bootloader. If it is "nobl", code is created for a board without a bootloader.</li><li>The <em>compiler</em> part indicates what compiler is used, and can be "mc" for the <a class="el" href="tools.html#tools_mplabc18">MPLAB C18 Compiler</a>, or "ht" for the <a class="el" href="tools.html#tools_picc18">Hi Tech PICC18 Compiler</a>.</li></ul>
<p>
Some example project names and their meanings are:<ul>
<li><b>udp1_65hw201_mc.mcp</b> Project file for the "UDP1" project. Uses the <a class="el" href="tools.html#tools_mplabc18">MPLAB C18 Compiler</a>. Creates code for the SBC65EC Hardware V2.01 target board with a bootloader.</li><li><b>tcp2_65hw201_nobl_ht.mcp</b> Project file for the "TCP2" project. Uses the <a class="el" href="tools.html#tools_picc18">Hi Tech PICC18 Compiler</a>. Creates code for the SBC65EC Hardware V2.01 target board without a bootloader.</li></ul>
<p>
To compile the project, simply install <a class="el" href="tools.html#tools_mplab">MPLAB IDE</a> and a compiler, open the project in MPLAB and click on the "Build All" toolbar button. This will compile the whole project and create the hex file.<h2><a class="anchor" name="page_examples_target">
Specifying the target board</a></h2>
Most of the examples have been configured to create code for the SBC65EC board. To compile code for other boards the user has to:<ul>
<li>Change the <code>define BRD_SBC65EC</code> line in the "projdefs.h" file (included with source code) for the desired target board.</li><li>Change the PIC chip in MPLAB for the selected processor. This is done in the "Configure", "Select Device" menu in MPLAB. For example, to compile for the SBC68EC, select the PIC18F6680 chip in MPLAB</li></ul>
<p>
The following settings have to be done for the following target boards:<ul>
<li>SBC65EC up to HW V2.01: Use BRD_SBC65EC define, select PIC18F6621 chip in MPLAB</li><li>SBC65EC from HW V2.02: Use BRD_SBC65EC define, select PIC18F6622 chip in MPLAB</li><li>SBC68EC: Use BRD_SBC68EC define, select PIC18F6680 chip in MPLAB</li><li>SBC44EC: Use BRD_SBC44EC define, select PIC18F452 chip in MPLAB</li><li>SBC45EC: Use BRD_SBC45EC define, select PIC18F452 chip in MPLAB</li></ul>
<h2><a class="anchor" name="page_examples_bootloader_compile">
Compiling code for the Bootloader</a></h2>
The <em>projectname_mc.mcp</em> or <em>projectname_ht.mcp</em> MPLAB project files located in the <em>../src</em> folder can be used to compile the example projects for use with a target board with bootloader. When compiling for use with a bootloader, the code starts from address 0x800 in stead of at address 0. The bootloader lives in the code space 0x0 to 0x7ff.<p>
To create a new MPLAB project for a target board with a bootloader, do the following: <ul>
<li>Include (uncomment) the "#define HAS_BOOTLOADER" line in "projdefs.h" </li>
<li>For the <b>HiTech</b> compiler, include the "-A800h" linker command line parameter. When using MPLAB, right click on project and select "Build Options" from the context menu. In the "Build Options" dialog box, select the "PICC-18 Linker" tab. In the "Specify offset for ROM" edit box, enter 800. </li>
<li>For <b>MPLAB</b> <b>C18</b> compiler, ensure the "18f6621_v300.lkr" file is included with the MPLAB project. This file is included in the project tree in MPLAB under "Linker Scripts".</li>
</ul>
<h2><a class="anchor" name="page_examples_bootloader_compile_non">
Compiling code for use without Bootloader</a></h2>
The <em>projectname_nobl_mc.mcp</em> or <em>projectname_nobl_ht.mcp</em> MPLAB project files located in the <em>../src</em> folder can be used to compile the example projects for use with a target board without a bootloader. This basically means that in stead of starting from address 0x800, the code starts from the normal location, address 0.<p>
To create a new MPLAB project for a target board without a bootloader, do the following: <ul>
<li>Remove (comment out) the "#define HAS_BOOTLOADER" line in "projdefs.h" </li>
<li>For the <b>HiTech</b> compiler, ensure the "-A800h" linker command line parameter is NOT present. When using MPLAB, right click on project and select "Build Options" from the context menu. In the "Build Options" dialog box, select the "PICC-18 Linker" tab. In the "Specify offset for ROM" edit box, enter 0. </li>
<li>For <b>MPLAB</b> <b>C18</b> compiler, ensure the "18f6621_v300_nobl.lkr" file is included with the MPLAB project. This file is included in the project tree in MPLAB under "Linker Scripts".</li>
</ul>
<h2><a class="anchor" name="page_examples_firmware_netloader">
Updating the Firmware with the Modtronix Network Bootloader</a></h2>
Some of the Modtronix Ethernet enabled boards have a Network Bootloader installed on them. The firmware on these boards can be updated without a PIC programmer. For details, click here.<h2><a class="anchor" name="page_examples_firmware_programer">
Updating the Firmware with a PIC Programmer</a></h2>
When the project has been compiled for a target board without a bootloader, a PIC programmer has to be used to program the target board. For details, <a href="http://www.modtronix.com/picboards/prog" target="_blank">click here</a>.<h2><a class="anchor" name="page_update_webpages">
Modifying And Updating The Web Pages</a></h2>
Most example projects have web pages that have to be put on the target board, and are used for web based control and monitoring of the target board. The source code for these web pages are always located in the <em>"../src/webpages/"</em> folder of the example source code. For details on the HTTP Web Server, supported file types, HTTP Compression, HTTP Authentication, CGI and Dynamic Web Pages see the HTTP Web Server section of this document.<p>
Web files can <b>not</b> be uploaded to the Modtronix TCP/IP Stack individually. All files have to be compiled into a File System Image, and then this image is uploaded to the target. The <a class="el" href="tools.html#tools_mxbootloader">Modtronix Network Bootloader</a> application is used to create this File System Image. After creating it, it can be uploaded to the target via the serial port (Xmodem protocol) or FTP.<h3><a class="anchor" name="page_update_webpages_ftp">
Uploading the File System Image with a FTP client</a></h3>
A FTP client can be used to connect to the target board and upload the File System Image. The default user name is "admin" and the password is "pw". After connecting to the target board, simply upload the entire File System Image file. After doing this, the target will contain the new Web pages.<p>
Total Commander is a great <b>free</b> application that can be used to do all ftp transfers. It can do much more then just ftp. To upload the File System Image with Total Command, do the following:<ul>
<li>Get a free download from <a href="http://www.ghisler.com" target="_blank">www.ghisler.com</a></li><li>Select [net][ftp connect] from menu</li><li>Click on "new connection" button</li><li>Enter any name in the "Session" box</li><li>Enter the target IP address in the "Host name" box, the default value is "10.1.0.1"</li><li>Enter your username and password in the "Username" and "Password" boxes. The default values are "admin" and "pw"</li><li>Connect and download the File System Image (default file is default.img) file containing the HTML pages</li></ul>
<h3><a class="anchor" name="page_update_webpages_xmodem">
Uploading the File System Image via the Xmodem protocol</a></h3>
A Terminal program capable of sending files via the Xmodem protocol can be used to send the File System Image file to the target. For this to work, the target has to be connected to the PC running the Terminal program (HyperTerminal on Windows for example) via its RS232 port. After powering up the target board, enter RS232 configuration mode by following the instructions displayed on the Terminal program. Then select "Download File System Image" from the menu, and send the created "File System Image" file via the Xmodem protocol. In HyperTerminal, this can be done by selecting the "Send File..." menu item in the "Transfer" menu. This will open the "Send File" dialog box. Select Xmodem protocol, and send the "File System Image" file created with the Modtronix Network Bootloader program. After doing this, the target will contain the new Web pages. <hr size="1"><address style="align: right;"><small>Generated on Fri Jan 13 21:46:52 2006 for Modtronix TCP/IP Stack Example Projects by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
